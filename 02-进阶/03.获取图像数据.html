<!--
 * @Author: zulezhe
 * @Date: 2021-01-28 17:00:12
 * @LastEditors: zulezhe
 * @LastEditTime: 2021-01-29 19:26:53
 * @Description: In User Settings Edit
 * @FilePath: \canvas\02-进阶\03.获取图像数据.html
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      html,
      body {
        width: 100%;
        height: 100%;
      }
      * {
        margin: 0;
        padding: 0;
      }
      #canvas-container {
        width: 100%;
        height: 100%;
      }
      canvas {
        outline: 1px dashed red;
      }
    </style>
  </head>
  <body>
    <div id="canvas-container"></div>
    <script src="./index.js"></script>
    <script>
      const mycanvas = new MyCanvas("canvas-container", 1800, 700);
      const context = mycanvas.getContext();
      drawImageData(context);
      getImageData(context);
      /**
       * 把图像绘制到画布上,可以传9个参数,
       * context.drawImage(image, dx, dy);
       * context.drawImage(image, dx, dy, dWidth, dHeight);
       * context.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);
       * Image:规定要使用的图像、画布或视频。
       * sx:可选。选择从图片上开始选区的 x 坐标位置。
       * sy:可选。选择从图片上开始选区的 y 坐标位置。
       * swidth:可选。被绘制图像的宽度。
       * sheight:可选。被绘制图像的高度。
       * dx:从画布的x坐标开始绘制
       * dy:从画布的y坐标开始绘制
       * width:可选,绘制到画布的宽度,可以拉伸或者压缩
       * height:可选绘制到画布的高度
       *
       * 可以创建一个空的imageData对象,对象中的像素信息为黑,返回ImageData对象
       * context.createImageData(width, height);
       *
       */
      /**
       * 把图像绘制到画布上,可以传9个参数,
       * context.drawImage(image, dx, dy);
       * context.drawImage(image, dx, dy, dWidth, dHeight);
       * context.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);
       * Image:  规定要使用的图像、画布或视频。
       * sx:     可选。从图片上 x 坐标位置开始选择像素点。
       * sy:     可选。从图片上 y 坐标位置开始选择像素点。
       * swidth: 可选。被绘制图像的宽度。
       * sheight:可选。被绘制图像的高度。
       * dx:     从画布的x坐标开始绘制
       * dy:     从画布的y坐标开始绘制
       * width:  可选,绘制到画布的宽度,可以拉伸或者压缩
       * height: 可选绘制到画布的高度
       *
       */
      function drawImageData(context) {
        const img = new Image();
        img.src = "./images//img1.jpg";
        img.onload = function () {
          console.log(1);
          context.drawImage(img, 0, 0, img.width, img.width);
        };
      }

      /**
       * 获取画布上的图像数据
       * context.getImageData(sx, sy, sw, sh);
       */
      function getImageData(context) {
        const img = new Image();
        img.src = "./images//img1.jpg";
        img.onload = function () {
          console.log(1);
          context.drawImage(img, 0, 0, img.width, img.width);
          const imageData = context.getImageData(0, 0, img.width, img.width);
          console.log(imageData, imageData.data.length);
          putImageData(context);
        };
      }
      /**
       * 将ImageData对象放到画布上
       * context.putImageData(imagedata, dx, dy);
       * context.putImageData(imagedata, dx, dy, dirtyX, dirtyY, dirtyWidth, dirtyHeight);
       * imagedata 包含图像像素信息的ImageData对象。
       * dx        把像素绘制到画布的x坐标
       * dy        把像素绘制到画布的y坐标
       * dirtyX  （可选）图像数据渲染区域的左上角横坐标。默认值是0。
       * dirtyY （可选）图像数据渲染区域的左上角纵坐标。默认值是0。
       * dirtyWidth（可选）图像数据渲染区域的宽度。默认值是imagedata图像的宽度。
       * dirtyHeight（可选） 图像数据渲染区域的高度。默认值是imagedata图像的高度。
       *context.createPattern(Image, repetition);平铺
       */
      function putImageData(context) {
        // 获取ImageData对象
        const imageData = context.getImageData(0, 0, 460, 460);
        console.log(imageData);
        //全像素绘制
        context.putImageData(imageData, 600, 0);
        // 对像素点进行裁剪然后绘制
        context.putImageData(imageData, 100, 100, 100, 0, 100, 100);
      }
    </script>
  </body>
</html>
